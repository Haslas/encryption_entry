from os import system


title="""
 __      ___                                  _____                             _   _             
 \ \    / (_)                                |  __ \                           | | (_)            
  \ \  / / _  __ _  ___ _ __   ___ _ __ ___  | |  | | ___  ___ _ __ _   _ _ __ | |_ _  ___  _ __  
   \ \/ / | |/ _` |/ _ \ '_ \ / _ \ '__/ _ \ | |  | |/ _ \/ __| '__| | | | '_ \| __| |/ _ \| '_ \ 
    \  /  | | (_| |  __/ | | |  __/ | |  __/ | |__| |  __/ (__| |  | |_| | |_) | |_| | (_) | | | |
     \/   |_|\__, |\___|_| |_|\___|_|  \___| |_____/ \___|\___|_|   \__, | .__/ \__|_|\___/|_| |_|
              __/ |                                                  __/ | |                      
             |___/                                                  |___/|_|                      
"""



ciphertext="""1PR ESS IIRTBUMYR KHW ESS DSCO, OUH ESS DSCO KHW HTHO KZO, OUH ESS DSCO KHW RZR.
2ALP DOTI HLG PR ESS IIRTBUMYR KPXS RCK.
3EWW HOMYRG DICP AHHP MM OMX; LBK ATEVVYE SWT ALD BVX LYM ALTYU TEOP HOEE HOZ QLOS.
4PR STA DED WWMI; LYR ALP WWMI HLG ALP WWNLE ZT TIY.
5LBK XSP ZPKSE GOMYPHO MY OOYOYPGZ; EYO HOI OLFRRPDG JSXAFLLPYRLH TE BVX.
6ESSYI HLG H QLY GLRE QFVQ RZR, DLZDS UEXP KHW UZVU.
7XSP GHQP NOTI QZF H ATEBLWD, EC IILC KPXYPGZ SQ EVL PTRVA, XSLH HPW XSU XSCCBKS SWT QTRVA FPWWLZP.
8SS DED YCA XSLH SMRSH, IYE HOZ WPYH AS MPOY ATEBLWD ZT ALLE ZPKSE.
9HOEE HOZ XSP HYYP WWNLE, HVPGS WWNLEPHO IGPFF QLY HOEE NCTIES WUXZ EVL AZCZK.
10LP HOZ MY EVL AZCZK, EYO HOI HZFSH HLG TEOP PF LTX, OUH ESS DSCWR RRPH VPQ YZH.
11OI NLAL YYEC OMD ZKU, EYO VPW ZHB YINPWCIO SWT RZE.
12PBX LD AHRJ LG YINPWCIO SWT, XZ EVLQ RLJL LP ACDIC EC IINZAL XSP GVRD ZT NSO, PJLR EZ HOIX EVHX MPZPIGP CU LTD BHQP:
13HVPGS HSYI MZFU, RZE CM FWZCK, RZC CM XSP KPPW ZT ALP QZLWS, YCY SQ EVL ATWZ VJ XLB, IYE ZT NSO.
14LBK XSP KVVO HOZ QLOS MPPDV, HRO OKLPE LAVRR FG, (HRO HS IISPZK LTD USSCJ, HOI RWCYC LD CM XSP CUPJ MSNSEESU SQ EVL JLEVLV,) QFZS SQ RFHGP LBK XCFHO.
15NZSB IECP KPXYPGZ SQ SWT, EYO QYMPO, GHCTYU, ALTD KHW SP CM ASZA P WALYL, LP EVHX NZALXS LTAIC XS PW ACSMICCSK FPQCYI XP: TVV SP KHW MPTVVP XS.
16HRO ZT OMD QISRPDG OEGP OSP HP FLGPTJLH, LYR NVLNS MSC RFHGP.
17QCY XSP ZHA HLG NMGPB IC XZGLW, MFH NVLNS HRO EFBXS NOTI MJ XLWFD QOVTDH.
18US XLB OEES GLIY RCK EE LBF XTXS; ALP ZBSC MPUVXEPB ZSY, HVPGS TG PR ESS ISDZA VJ ESS MEESSY, LP SOAL OPQSECPR OMX.
19LBK XSTG PW ESS YINZFK SQ UCOR, HSSU XSP XLAD DSUX ACWLWED OUH WPJPXPD TYSX USYYDLZLQ EZ OZO STA, DLZ LFA XSZI?
20HRO SS JSYQSZWPO, OUH OPBPIO YCA; FFE QVRQPGZIO, T OT RZE HOI NSFPWE.
21LBK XSPM HWVPR OMX, HVHX ESSU? ECE HOSF PZPED? LBK LP DOPXS, T OT RZE. OYX ESCB XSLH WVZAVLX? LYR OI LYGDICPR, US.
22ESSU WLTR ALPJ IUXZ SWT, ASZ OYX ESCB? XSLH DI XLM NMGP OU EYDKLV EZ HOIX EVHX DPBA YD. HVHX DLMLWE EVVY ZQ HOCDPZM?
23LP DOPH, T LA ALP GCPGP ZT VRP NFFMYR WU XSP KPPOPFUIDD, AHOP DHYETRVA XSP KHC ZQ HOI WZFK, ED DOPH ESS WVZAVLX PDOPED.
24LBK XSPM DLTNV DICP GLRE HSYI ZQ HOI ASOYMDPSZ.
25EYO HOIJ LGRIO SWT, EYO GHMO FBAS STA, DLJ MOWXTKSZX ESCB XSPB, PJ ESCB FP YCA XSLH JLCTGA, RZC SSMLD, BLMESSY XSLH WVZAVLX?
26UZVU EYDKLVPO HOIX, DOFMYR, W IEAEWGI HTHO ALESY: FFE HOICP GAEYOSAL ZYS HQZYU FSF, HVVQ JP YUSH YCA;
27LP TH PW, HSC JSXTBN EQESY QP TG WVPQSYVPO PLJZCS TI, HSCZI DSCL'W WLHJLPE W HQ YZH DSCEVF XZ FBSSZDS.
28ALPDS ALTYUZ APCS KSYP WU FPEVHFLCO IIJZBK NZCRHR, HSSYI UZVU ALD PHTETNPRR.
29EVL RPIH KEJ UCOR DPSAL UPGBW NZAPRR FBAS STA, HRO DOPXS, MSOSWO HOI WLAI SQ RCK, ASTQO XLVSAL LHOF XSP GPR ZQ HOI HZFSH.
30ESWZ MD SS VJ HSCT M DLWK, EQESY QP NCTIES O TEY HVPGS TG WVPQSYVPO PLJZCS TI: QZF OI HLG IIQZFL QP.
31LBK M VYSD LTX BVX: MFH ALLE VL WSZISH MP AHHP XOUMQPGA XZ TGYEPW, HOICPTVVP LA P GZXS IEAEWGMYR KPXS HOAIC.
32LBK NZSB IECP FLGZCR, ZEJTBN, M DLK ALP DDPVTE RLWNPBKMYR TYSX SSHZPY ZPOP L RVZP, LBK ME LPVHP FDVR STA.
33HRO T YUIH SWT RZE: PBX SP HOEE DSUX XP HV FLAHPDP HWAL HLHLV, ESS ZEXP GHMO FBAS XP, IWSY HVVQ ESCB WSLZA WPP HOI DAWYME OSZGPYRPRR, LBK VPXOPRTYU VR STA, ALP DOTI TD VL ASTQO FLAHPDPEV DMES HOI SZZF KSZGA.
34EYO W ZEH, LBK FLCS YINZFK XSLH ALTD WZ XSP GVR ZQ UVH.
35LROPR ESS UIIE RHC LQHLV UZVU WEZCK, EYO HDS ZQ VPW OTGJMAWSZ;
36EYO ZVSVTBN YAZB QIDFG HW SP KHPVPR, OI DLWAL, MPVVPO EVL PLXP VJ RZR!
37HRO EVL XHZ RPWNTDSID SSHVO SWT WAPOR, EYO HOIJ QCSPZHSK NPDIZ.
38XSPB QIDFG AYCYSK, EYO GHA ESST JZWZVATYU, HRO DOPXS FBAS ESST, ASLH ZIPV ML? XSPM ZETO IUXZ SWT, VLMPP, (ASTQO MD EC ZEJ, MSPRR TBAICAFLXPO, AHWEPF,) DLPCS KAPWZLWE EVVY?
39SP GHMES IUXZ EVLQ, NZAL EYO GLI. ESSF GLXS HRO DOD ASPFL LP OKLPE, LBK EMZRL ATEV OMX EVHX OLM: MSC TH DED LPVYE EVL XPYHO LZFF.
40VRP ZT ALP EKV ASTQO LPLFK NZSB ZTPLY, HRO QCSPZHSK LTX, KHW LYRYIH, DWTSY ASAIC'D PYSESSY.
41LP QWYWE QWUHPEV OMD ZKU FCZHOIC DWTSY, LBK WLTHO YYEC OMX, HS OEGP TVYYO HOI XPGZMLD, KOMNS WZ, FPTBN MYESYTCPHLH, ESS JLCTGA.
42EYO VL FCZINLE SWT XZ USZYD. LBK ASPB QIDFG IISPZK LTX, VL WLTR, ALZF OYX DTAVR ESS ZSY ZT QSYL: HOSF DVHPE MS JEWWSK GPAVHW, HSWJL TD PF MYESYTCPHHXTZB, H WEZBL.
43XSP RHC QZZSSHTBN NPDIZ AZFZK KZ QCYXS TBAS RLZPPPP, OUH QTBKIES DOMWTD, HRO DOPXS FBAS STA, MSWWCD QP.
44YCD TSTZPT HLG VJ MPHOWLTRH, XSP QPXJ ZT HROCSD EYO DLXPC.
45DOMWTD MMYOSAL YLHOEYLSS, EYO GHMES IUXZ SWT, AP SOCI QZIUH STA, VJ HSCT QZDSZ MY EVL PLH, OUH ESS WVZAVLXD, OWK ACTHL, NPDIZ SQ YOGECPHO, XSP GVR ZQ XVWPAV.
46HRO YOALLYOLP DLWK YYEC OMX, NOU XSPFL EYJ UVSO EVPRR NCTI ZFH VJ YLNHVPEV? WLTWWW WLTHO YYEC OMX, NCTI LYR ZIP.
47USZYD DOD RLEVHRLPZ JSXTBN XZ SWT, EYO GHMES CM LTX, PLLZWR HR TDFHIWTHL MYOSLH, TY KOSX TG US RFWSI!
48YLHOEYLSS WLTHO YYEC OMX, HVLRNP YUSHPGA XSZI TI? UPGBW LYGDICPR HRO DOPH FYHV LTX, PLJZCS ALLE DOMWTD JEWWSK XSPS, DLPY HOSF HOZX FYRLV ESS MMR EFLI, T DOD XSPS.
49UEESOUEPW OUWHPFLH LYR ZETEV BREZ VPQ, CLPIM, ESCB ECE HOI DZB VJ RZR; ALZF OYX ESS RMYR CM MDCOLP.
50UPGBW LYGDICPR HRO DOPH FYHV LTX, PLGLFGL M DLWK YYEC ALPP, W ZEH EVLI FYRLV ESS MMR EFLI, MPZPIGPGA XSZI? ALZF GOEWE GLI RCSHXPC HOMYRG ALLY HOIDP.
51OUH SP GHMES IUXZ SWT, ZPCWSC, GPFPPJ, T GHC FYHV CZF, VLVPLTAIC JS ZLLWZ ZIP SSHZPY CWIY, LBK XSP OUKPWG VJ RZR HWNPBKMYR OUH OPGJIYOWUK FACU XSP GVR ZQ AHR.
ESS WEDDKVVO TG ALP VSF"""

def main():
    print(title)


    print("\n\nDecrypt the ciphertext, and input the key you find as the password to the main console")
    print("The trick to finding how long the key to a Vigenere cipher is, is to try differenr lengths until multiple data sets similar to normal english frequency appear.")
    print("Though it's always handy to remember that the average word in the english language is five letters long (hint hint hint)")
    print("After that, comparing the most frequent letters in each substitution alphabet to the most commong in standard english helps guess the shift, and the key")
    
    print("\nCommands: displayCiphertext() decrypt(\"key\") getFrequenciesForGroupSize(keyLength) launchVigenereSquare() getMostCommonCharacterPerGroup(keyLength) exit()")
    print("If using decrypt(\"key\"), replace the word key with the word you think the key is, but keep the quotation marks")
    print("If usinggetFrequenciesForGroupSize(keyLength) or getMostCommonCharacterPerGroup(keyLength) replace groupSize with the number equal to how long you think the key is")
    running = True
    while running:
        try:
            command=input("Command: ")
            #not bullet proof checking but it'll do:
            if command[:4] == "getF" or command[:4] =="decr" or command[:4] == "laun" or command[:4] == "exit" or command[:4]=="disp" or command[:4] == "getM":
                running = eval(command)
            else:
                print("Didn't understand that")
        except:
            print("Didn't understand that")

def displayCiphertext():
    print(ciphertext)
    return True

def getMostCommonCharacterPerGroup(groupSize):
    frequencyArrays = getGroupsFreq(ciphertext, groupSize)
    mostCommonCharacters=[]
    for frequencyArray in frequencyArrays:
        index=0
        maxIndex=0
        maxValue=0
        for value in frequencyArray:
            if value>maxValue:
                maxValue=value
                maxIndex=index
            index+=1
        mostCommonCharacters.append(chr(maxIndex+65))
    for num in range(len(mostCommonCharacters)):
        print("Group"+str(num)+": "+mostCommonCharacters[num])
    return True
            
def decrypt(key):
    print(decryptV(ciphertext, key))
    return True

def displayEnglishCharacterPercentages():
    englishFreq=["8.2%","1.5%","2.8%","4.3%","13%","2.2%","2.0%","6.1%","7.0%","0.15%","0.77%","4.0%","2.4%","6.7%","7.5%","1.9%","0.095%","6.0%","6.3%","9.1%","2.8%","0.98%","2.4%","0.15%","2.0%","0.074%"]
    displayFreqArray(englishFreq)
    return True


def getFrequenciesForGroupSize(groupSize):
    frequencyArrays = getGroupsFreq(ciphertext, groupSize)
    print(len(frequencyArrays))
    for num in range(len(frequencyArrays)):
        print("Group"+str(num)+": ",end="")
        displayFreqArray(frequencyArrays[num])
    return True

def exit():
    return False

def launchVigenereSquare():
    try:
        system("start simulations\\simV.py")
    except:
        system("start simV.py")
    return True
    

def freqAnalysis(ciphertext):
    freqArray = [0 for num in range(0,26)]
    for char in ciphertext.upper():
        if(ord(char)>=65 and ord(char)<=90):
            freqArray[ord(char)-65]+=1
    return freqArray

def percentFreqAnalysis(ciphertext):
    freqArray = freqAnalysis(ciphertext)
    onlyLetters = ""
    for char in ciphertext.upper():
        if(ord(char)>=65 and ord(char)<=90):
            onlyLetters+=char
    length = len(onlyLetters)
    percentArray = [0 for num in range(0,26)]
    for num in range(0,26):
        percentArray[num] = round(((freqArray[num] / length)*100), 3)

    return percentArray
    

def displayFreqArray(freqArray):
    for num in range(0,26):
        print(" | "+chr(num+65)+" : "+str(freqArray[num]), end="")
    print(" |")


def caesarDecrypt(ciphertext, shift):
    plaintext = ""
    for char in ciphertext.upper():
        if(ord(char)>=65 and ord(char)<=90):
            newChar = chr(((ord(char)-65+shift)%26)+65)
            plaintext+=newChar
        else:
            plaintext+=char
    return plaintext


def splitCiphertextIntoGroups(ciphertext, numberOfGroups):
    justLetters = ""
    for char in ciphertext:
        if ord(char)<=90 and ord(char) >= 65:
            justLetters+=char

    groupsArray = ["" for num in range(0,numberOfGroups)]
    for num in range(0, len(justLetters)):
        groupsArray[num%numberOfGroups]+=justLetters[num]
    return groupsArray

def getGroupsFreq(ciphertext, groupSize):
    groupsArray = splitCiphertextIntoGroups(ciphertext, groupSize)
    freqArrays = []
    for group in groupsArray:
        freqArrays.append(freqAnalysis(group))
    return freqArrays


def generateVSquare():
    #Coords:
    #(0,0) (1,0) ..
    #(0,1) (1,1) ...
    vSquare=[]
    for colIndex in range(26):
        row = []
        for rowIndex in range(26,):
            letter = chr(((colIndex+rowIndex)%26)+65)
            row.append(letter)
        vSquare.append(row)
    return vSquare

def getVSquareCoords(plainChar, keyChar):
    x=ord(plainChar.upper())-65
    y=ord(keyChar.upper())-65
    return generateVSquare()[x][y]

def decryptCharacter(cipherChar, keyChar):
    cipherChar = cipherChar.upper()
    keyChar = keyChar.upper()
    vSquare = generateVSquare()
    y=ord(keyChar.upper())-65
    x=0
    index = 0
    for char in vSquare[y]:
        if char == cipherChar.upper():
            x=index
        index+=1
    plainChar = chr(x+65)
    return plainChar

def decryptV(ciphertext, key):
    key=key.upper()
    plaintext = ""
    index=0
    for cipherChar in ciphertext.upper():
        if(ord(cipherChar)>=65 and ord(cipherChar)<=90): 
            plaintext+=decryptCharacter(cipherChar, key[index%len(key)])
            index+=1
        else:
            plaintext+=cipherChar
    return plaintext
    
main()


